}
# Create data.table from named vector
dt <- data.table(
name =   sub("-[0-9]+$", "", names(all_cpg_values)), # just keep the C position instead of C + 1
alpha = as.numeric(all_cpg_values)
)
#######################################################################
# Parse "chr_pos" in name into chr, start_pos, end_pos. NB: takes a couple of minutes
dt[, c("chr", "pos") := tstrsplit(name, "_", fixed = TRUE)]
# Convert to integer/numeric if not already
dt[, pos := as.integer(pos)]
## Check chromosomes present:
message("Chromosomes in the dataset:")
table(unique(dt$chr))
# Convert chr from "chrN" to  factor
dt[, chr := sub("chr", "", chr)]
dt[, chr := factor(chr, levels = as.character(c(1:22, "X", "Y", "M")))]
## Check chromosomes order:
message("Chromosomes in the dataset:")
table(unique(dt$chr))
## Mark group membership in dt
dt[, group := NA_character_]
dt[name %in% DerakhshanhvCpGs_hg38, group := "hvCpG_Derakhshan"]
dt[name %in% mQTLcontrols_hg38, group := "mQTLcontrols"]
# Compute cumulative position offsets for Manhattan plot
setorder(dt, chr, pos)
offsets <- dt[, .(max_pos = max(pos, na.rm = TRUE)), by = chr]
offsets[, cum_offset := c(0, head(cumsum(as.numeric(max_pos)), -1))]
dt <- merge(dt, offsets[, .(chr, cum_offset)], by = "chr", all.x = TRUE, sort = FALSE)
# Convert to integer/numeric if not already
dt[, cum_offset := as.numeric(cum_offset)]
dt[, pos2 := pos + cum_offset]
return(dt)
}
system.time(Atlas_dt <- prepAtlasdt(file))
nrow(Atlas_dt) # 23036026
head(Atlas_dt$alpha)
## NB add test on package row by col
if (exists("doIprepAtlas") && isTRUE(doIprepAtlas)) {
stop("stop here to only prepare atlas_dt")
}
# Compute chromosome centers for x-axis labeling
df2 <- Atlas_dt[, .(center = mean(range(pos2, na.rm = TRUE))), by = chr]
df2 <- merge(data.frame(chr = factor(c(1:22, "X", "Y", "M"), levels=as.character(c(1:22, "X", "Y", "M")))),
df2, by = "chr", all.x = TRUE, sort = TRUE)
df2 <- na.omit(df2)
# Compute chromosome boundaries
df_bounds <- Atlas_dt[, .(min_pos = min(pos2, na.rm = TRUE),
max_pos = max(pos2, na.rm = TRUE)), by = chr]
# Midpoints between chromosomes = where to draw dotted lines
df_bounds[, next_start := data.table::shift(min_pos, n = 1, type = "lead")]
vlines <- df_bounds[!is.na(next_start), .(xintercept = (max_pos + next_start)/2)]
plot <- ggplot() +
# background cloud
geom_point_rast(data = Atlas_dt[is.na(group)],
aes(x = pos2, y = alpha),
color = "black", size = 0.01, alpha = 0.01, raster.dpi = 72) +
# hvCpG highlights
geom_point(data = Atlas_dt[group == "hvCpG_Derakhshan"],
aes(x = pos2, y = alpha),
color = "#DC3220", size = 1, alpha = 0.7) +
# mQTL controls highlights
geom_point(data = Atlas_dt[group == "mQTLcontrols"],
aes(x = pos2, y = alpha),
color = "#005AB5", size = 1, alpha = 0.7) +
# Add dotted separators
geom_vline(data = vlines, aes(xintercept = xintercept),
linetype = 3, color = "grey60") +
theme_classic() + theme(legend.position = "none") +
scale_x_continuous(breaks = df2$center, labels = as.character(df2$chr), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chromosome", y = "Probability of being a hvCpG")+
theme_minimal(base_size = 14)
# Save as PDF â€” rasterization improves performance and file size
CairoPDF(here(paste0("05_hvCpGalgorithm/figures/ManhattanAlphaPlot_", file, ".pdf")), width = 15, height = 3)
print(plot)
dev.off()
}
####################################################################
## Plot secondary analyses results of algorithm ran on atlas data ##
####################################################################
library(here)
source(here("05_hvCpGalgorithm", "quiet_library.R"))
## Load array results
resArray <- readRDS(here("05_hvCpGalgorithm/dataOut/resArray.RDS"))
## Add previous MEs including Maria's results
source(here("05_hvCpGalgorithm/exploreResults/prepPreviousSIV.R"))
################################
## Load data & Manhattan plot ##
################################
for (file in list.files(here("05_hvCpGalgorithm/resultsDir/Atlas/"))){
prepAtlasdt <- function(dir = "Atlas10X"){
# Define parent folder containing all "Atlas_batchXXX" folders
parent_dir = here(paste0("05_hvCpGalgorithm/resultsDir/Atlas/", dir))
# Get list of relevant RDS files
rds_files <- dir(parent_dir, pattern = ".rds$",
recursive = TRUE, full.names = TRUE)
rds_files
all_cpg_values <- numeric()
pb <- progress_bar$new(total = length(rds_files), format = "ðŸ“¦ :current/:total [:bar] :percent")
for (file in rds_files) {
obj <- readRDS(file)
if (is.matrix(obj)) obj <- obj[, 1]
all_cpg_values <- c(all_cpg_values, obj)
pb$tick()
}
# Create data.table from named vector
dt <- data.table(
name =   sub("-[0-9]+$", "", names(all_cpg_values)), # just keep the C position instead of C + 1
alpha = as.numeric(all_cpg_values)
)
#######################################################################
# Parse "chr_pos" in name into chr, start_pos, end_pos. NB: takes a couple of minutes
dt[, c("chr", "pos") := tstrsplit(name, "_", fixed = TRUE)]
# Convert to integer/numeric if not already
dt[, pos := as.integer(pos)]
## Check chromosomes present:
message("Chromosomes in the dataset:")
table(unique(dt$chr))
# Convert chr from "chrN" to  factor
dt[, chr := sub("chr", "", chr)]
dt[, chr := factor(chr, levels = as.character(c(1:22, "X", "Y", "M")))]
## Check chromosomes order:
message("Chromosomes in the dataset:")
table(unique(dt$chr))
## Mark group membership in dt
dt[, group := NA_character_]
dt[name %in% DerakhshanhvCpGs_hg38, group := "hvCpG_Derakhshan"]
dt[name %in% mQTLcontrols_hg38, group := "mQTLcontrols"]
# Compute cumulative position offsets for Manhattan plot
setorder(dt, chr, pos)
offsets <- dt[, .(max_pos = max(pos, na.rm = TRUE)), by = chr]
offsets[, cum_offset := c(0, head(cumsum(as.numeric(max_pos)), -1))]
dt <- merge(dt, offsets[, .(chr, cum_offset)], by = "chr", all.x = TRUE, sort = FALSE)
# Convert to integer/numeric if not already
dt[, cum_offset := as.numeric(cum_offset)]
dt[, pos2 := pos + cum_offset]
return(dt)
}
system.time(Atlas_dt <- prepAtlasdt(file))
nrow(Atlas_dt) # 23036026
head(Atlas_dt$alpha)
## NB add test on package row by col
if (exists("doIprepAtlas") && isTRUE(doIprepAtlas)) {
stop("stop here to only prepare atlas_dt")
}
# Compute chromosome centers for x-axis labeling
df2 <- Atlas_dt[, .(center = mean(range(pos2, na.rm = TRUE))), by = chr]
df2 <- merge(data.frame(chr = factor(c(1:22, "X", "Y", "M"), levels=as.character(c(1:22, "X", "Y", "M")))),
df2, by = "chr", all.x = TRUE, sort = TRUE)
df2 <- na.omit(df2)
# Compute chromosome boundaries
df_bounds <- Atlas_dt[, .(min_pos = min(pos2, na.rm = TRUE),
max_pos = max(pos2, na.rm = TRUE)), by = chr]
# Midpoints between chromosomes = where to draw dotted lines
df_bounds[, next_start := data.table::shift(min_pos, n = 1, type = "lead")]
vlines <- df_bounds[!is.na(next_start), .(xintercept = (max_pos + next_start)/2)]
plot <- ggplot() +
# background cloud
geom_point_rast(data = Atlas_dt[is.na(group)],
aes(x = pos2, y = alpha),
color = "black", size = 0.01, alpha = 0.01, raster.dpi = 72) +
# hvCpG highlights
geom_point(data = Atlas_dt[group == "hvCpG_Derakhshan"],
aes(x = pos2, y = alpha),
color = "#DC3220", size = 1, alpha = 0.7) +
# mQTL controls highlights
geom_point(data = Atlas_dt[group == "mQTLcontrols"],
aes(x = pos2, y = alpha),
color = "#005AB5", size = 1, alpha = 0.7) +
# Add dotted separators
geom_vline(data = vlines, aes(xintercept = xintercept),
linetype = 3, color = "grey60") +
theme_classic() + theme(legend.position = "none") +
scale_x_continuous(breaks = df2$center, labels = as.character(df2$chr), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Chromosome", y = "Probability of being a hvCpG")+
theme_minimal(base_size = 14)
# Save as PDF â€” rasterization improves performance and file size
CairoPDF(here(paste0("05_hvCpGalgorithm/figures/ManhattanAlphaPlot_", file, ".pdf")), width = 15, height = 3)
print(plot)
dev.off()
}
####################################################################
## Plot secondary analyses results of algorithm ran on atlas data ##
####################################################################
library(here)
source(here("05_hvCpGalgorithm", "quiet_library.R"))
####################################################################
## Plot secondary analyses results of algorithm ran on atlas data ##
####################################################################
library(here)
source(here("05_hvCpGalgorithm", "quiet_library.R"))
## Add previous MEs including Maria's results
source(here("05_hvCpGalgorithm/exploreResults/prepPreviousSIV.R"))
prepAtlasdt <- function(dir = "Atlas10X"){
# Define parent folder containing all "Atlas_batchXXX" folders
parent_dir = here(paste0("05_hvCpGalgorithm/resultsDir/Atlas/", dir))
# Get list of relevant RDS files
rds_files <- dir(parent_dir, pattern = ".rds$",
recursive = TRUE, full.names = TRUE)
rds_files
all_cpg_values <- numeric()
pb <- progress_bar$new(total = length(rds_files), format = "ðŸ“¦ :current/:total [:bar] :percent")
for (file in rds_files) {
obj <- readRDS(file)
if (is.matrix(obj)) obj <- obj[, 1]
all_cpg_values <- c(all_cpg_values, obj)
pb$tick()
}
# Create data.table from named vector
dt <- data.table(
name =   sub("-[0-9]+$", "", names(all_cpg_values)), # just keep the C position instead of C + 1
alpha = as.numeric(all_cpg_values)
)
#######################################################################
# Parse "chr_pos" in name into chr, start_pos, end_pos. NB: takes a couple of minutes
dt[, c("chr", "pos") := tstrsplit(name, "_", fixed = TRUE)]
# Convert to integer/numeric if not already
dt[, pos := as.integer(pos)]
## Check chromosomes present:
message("Chromosomes in the dataset:")
table(unique(dt$chr))
# Convert chr from "chrN" to  factor
dt[, chr := sub("chr", "", chr)]
dt[, chr := factor(chr, levels = as.character(c(1:22, "X", "Y", "M")))]
## Check chromosomes order:
message("Chromosomes in the dataset:")
table(unique(dt$chr))
## Mark group membership in dt
dt[, group := NA_character_]
dt[name %in% DerakhshanhvCpGs_hg38, group := "hvCpG_Derakhshan"]
dt[name %in% mQTLcontrols_hg38, group := "mQTLcontrols"]
# Compute cumulative position offsets for Manhattan plot
setorder(dt, chr, pos)
offsets <- dt[, .(max_pos = max(pos, na.rm = TRUE)), by = chr]
offsets[, cum_offset := c(0, head(cumsum(as.numeric(max_pos)), -1))]
dt <- merge(dt, offsets[, .(chr, cum_offset)], by = "chr", all.x = TRUE, sort = FALSE)
# Convert to integer/numeric if not already
dt[, cum_offset := as.numeric(cum_offset)]
dt[, pos2 := pos + cum_offset]
return(dt)
}
list.files(here("05_hvCpGalgorithm/resultsDir/Atlas/"))
system.time(Atlas_dt_Atlas10X <- prepAtlasdt("Atlas10X"))
Atlas_dt_Atlas10X
head(Atlas_dt_Atlas10X)
for (file in list.files(here("05_hvCpGalgorithm/resultsDir/Atlas/"))){
file
}
for (file in list.files(here("05_hvCpGalgorithm/resultsDir/Atlas/"))){
print(file)
}
for (file in list.files(here("05_hvCpGalgorithm/resultsDir/Atlas/"))){
print(here(paste0("gitignore/", file)))
}
print(here(paste0("gitignore/fullres_", file)))
for (file in list.files(here("05_hvCpGalgorithm/resultsDir/Atlas/"))){
print(here(paste0("gitignore/fullres_", file)))
}
print("Number of CpG tested:/n")
print(3)
print("Number of CpG tested:\n")
print(3)
print("Number of CpG tested:")
print(3)
print(paste0("Save results for ", file, ":"))
print(paste0("Saving results for ", file, "..."))
print(paste0("Saving results for ", file, "in ", here(paste0("gitignore/fullres_", file)), "..."))
print(paste0("Saving results for ", file, "in ", here(paste0("gitignore/fullres_", file))))
print("Saved")
####################################################################
## Plot secondary analyses results of algorithm ran on atlas data ##
####################################################################
library(here)
source(here("05_hvCpGalgorithm", "quiet_library.R"))
## Add previous MEs including Maria's results
source(here("05_hvCpGalgorithm/exploreResults/prepPreviousSIV.R"))
##################################
## Save all data in RDS objects ##
##################################
for (file in list.files(here("05_hvCpGalgorithm/resultsDir/Atlas/"))){
prepAtlasdt <- function(dir = "Atlas10X"){
# Define parent folder containing all "Atlas_batchXXX" folders
parent_dir = here(paste0("05_hvCpGalgorithm/resultsDir/Atlas/", dir))
# Get list of relevant RDS files
rds_files <- dir(parent_dir, pattern = ".rds$",
recursive = TRUE, full.names = TRUE)
rds_files
all_cpg_values <- numeric()
pb <- progress_bar$new(total = length(rds_files), format = "ðŸ“¦ :current/:total [:bar] :percent")
for (file in rds_files) {
obj <- readRDS(file)
if (is.matrix(obj)) obj <- obj[, 1]
all_cpg_values <- c(all_cpg_values, obj)
pb$tick()
}
# Create data.table from named vector
dt <- data.table(
name =   sub("-[0-9]+$", "", names(all_cpg_values)), # just keep the C position instead of C + 1
alpha = as.numeric(all_cpg_values)
)
#######################################################################
# Parse "chr_pos" in name into chr, start_pos, end_pos. NB: takes a couple of minutes
dt[, c("chr", "pos") := tstrsplit(name, "_", fixed = TRUE)]
# Convert to integer/numeric if not already
dt[, pos := as.integer(pos)]
## Check chromosomes present:
message("Chromosomes in the dataset:")
table(unique(dt$chr))
# Convert chr from "chrN" to  factor
dt[, chr := sub("chr", "", chr)]
dt[, chr := factor(chr, levels = as.character(c(1:22, "X", "Y", "M")))]
## Check chromosomes order:
message("Chromosomes in the dataset:")
table(unique(dt$chr))
## Mark group membership in dt
dt[, group := NA_character_]
dt[name %in% DerakhshanhvCpGs_hg38, group := "hvCpG_Derakhshan"]
dt[name %in% mQTLcontrols_hg38, group := "mQTLcontrols"]
# Compute cumulative position offsets for Manhattan plot
setorder(dt, chr, pos)
offsets <- dt[, .(max_pos = max(pos, na.rm = TRUE)), by = chr]
offsets[, cum_offset := c(0, head(cumsum(as.numeric(max_pos)), -1))]
dt <- merge(dt, offsets[, .(chr, cum_offset)], by = "chr", all.x = TRUE, sort = FALSE)
# Convert to integer/numeric if not already
dt[, cum_offset := as.numeric(cum_offset)]
dt[, pos2 := pos + cum_offset]
return(dt)
}
system.time(Atlas_dt <- prepAtlasdt(file))
print("Number of CpG tested:")
print(nrow(Atlas_dt)) # 23036026
print(paste0("Saving results for ", file, "in ", here(paste0("gitignore/fullres_", file))))
saveRDS(Atlas_dt, file = here(paste0("gitignore/fullres_", file)))
print("Saved")
}
####################################################################
## Plot secondary analyses results of algorithm ran on atlas data ##
####################################################################
library(here)
source(here("05_hvCpGalgorithm", "quiet_library.R"))
##################################
## Save all data in RDS objects ##
##################################
saveAgain = FALSE
if (saveAgain){
## Add previous MEs including Maria's results
source(here("05_hvCpGalgorithm/exploreResults/prepPreviousSIV.R"))
for (file in list.files(here("05_hvCpGalgorithm/resultsDir/Atlas/"))){
prepAtlasdt <- function(dir = "Atlas10X"){
# Define parent folder containing all "Atlas_batchXXX" folders
parent_dir = here(paste0("05_hvCpGalgorithm/resultsDir/Atlas/", dir))
# Get list of relevant RDS files
rds_files <- dir(parent_dir, pattern = ".rds$",
recursive = TRUE, full.names = TRUE)
rds_files
all_cpg_values <- numeric()
pb <- progress_bar$new(total = length(rds_files), format = "ðŸ“¦ :current/:total [:bar] :percent")
for (file in rds_files) {
obj <- readRDS(file)
if (is.matrix(obj)) obj <- obj[, 1]
all_cpg_values <- c(all_cpg_values, obj)
pb$tick()
}
# Create data.table from named vector
dt <- data.table(
name =   sub("-[0-9]+$", "", names(all_cpg_values)), # just keep the C position instead of C + 1
alpha = as.numeric(all_cpg_values)
)
#######################################################################
# Parse "chr_pos" in name into chr, start_pos, end_pos. NB: takes a couple of minutes
dt[, c("chr", "pos") := tstrsplit(name, "_", fixed = TRUE)]
# Convert to integer/numeric if not already
dt[, pos := as.integer(pos)]
## Check chromosomes present:
message("Chromosomes in the dataset:")
table(unique(dt$chr))
# Convert chr from "chrN" to  factor
dt[, chr := sub("chr", "", chr)]
dt[, chr := factor(chr, levels = as.character(c(1:22, "X", "Y", "M")))]
## Check chromosomes order:
message("Chromosomes in the dataset:")
table(unique(dt$chr))
## Mark group membership in dt
dt[, group := NA_character_]
dt[name %in% DerakhshanhvCpGs_hg38, group := "hvCpG_Derakhshan"]
dt[name %in% mQTLcontrols_hg38, group := "mQTLcontrols"]
# Compute cumulative position offsets for Manhattan plot
setorder(dt, chr, pos)
offsets <- dt[, .(max_pos = max(pos, na.rm = TRUE)), by = chr]
offsets[, cum_offset := c(0, head(cumsum(as.numeric(max_pos)), -1))]
dt <- merge(dt, offsets[, .(chr, cum_offset)], by = "chr", all.x = TRUE, sort = FALSE)
# Convert to integer/numeric if not already
dt[, cum_offset := as.numeric(cum_offset)]
dt[, pos2 := pos + cum_offset]
return(dt)
}
system.time(Atlas_dt <- prepAtlasdt(file))
print("Number of CpG tested:")
print(nrow(Atlas_dt)) # 23036026
print(paste0("Saving results for ", file, "in ", here(paste0("gitignore/fullres_", file))))
saveRDS(Atlas_dt, file = here(paste0("gitignore/fullres_", file)))
print("Saved")
}
}
list.files(here("gitignore"))
fullres_Atlas10X <- readRDS(here(paste0("gitignore/fullres_Atlas10X", file)))
fullres_Atlas10X <- readRDS(here("gitignore/fullres_Atlas10X"))
####################################################################
## Plot secondary analyses results of algorithm ran on atlas data ##
####################################################################
library(here)
source(here("05_hvCpGalgorithm", "quiet_library.R"))
##################################
## Save all data in RDS objects ##
##################################
saveAgain = FALSE
if (saveAgain){
## Add previous MEs including Maria's results
source(here("05_hvCpGalgorithm/exploreResults/prepPreviousSIV.R"))
for (file in list.files(here("05_hvCpGalgorithm/resultsDir/Atlas/"))){
prepAtlasdt <- function(dir = "Atlas10X"){
# Define parent folder containing all "Atlas_batchXXX" folders
parent_dir = here(paste0("05_hvCpGalgorithm/resultsDir/Atlas/", dir))
# Get list of relevant RDS files
rds_files <- dir(parent_dir, pattern = ".rds$",
recursive = TRUE, full.names = TRUE)
rds_files
all_cpg_values <- numeric()
pb <- progress_bar$new(total = length(rds_files), format = "ðŸ“¦ :current/:total [:bar] :percent")
for (file in rds_files) {
obj <- readRDS(file)
if (is.matrix(obj)) obj <- obj[, 1]
all_cpg_values <- c(all_cpg_values, obj)
pb$tick()
}
# Create data.table from named vector
dt <- data.table(
name =   sub("-[0-9]+$", "", names(all_cpg_values)), # just keep the C position instead of C + 1
alpha = as.numeric(all_cpg_values)
)
#######################################################################
# Parse "chr_pos" in name into chr, start_pos, end_pos. NB: takes a couple of minutes
dt[, c("chr", "pos") := tstrsplit(name, "_", fixed = TRUE)]
# Convert to integer/numeric if not already
dt[, pos := as.integer(pos)]
## Check chromosomes present:
message("Chromosomes in the dataset:")
table(unique(dt$chr))
# Convert chr from "chrN" to  factor
dt[, chr := sub("chr", "", chr)]
dt[, chr := factor(chr, levels = as.character(c(1:22, "X", "Y", "M")))]
## Check chromosomes order:
message("Chromosomes in the dataset:")
table(unique(dt$chr))
## Mark group membership in dt
dt[, group := NA_character_]
dt[name %in% DerakhshanhvCpGs_hg38, group := "hvCpG_Derakhshan"]
dt[name %in% mQTLcontrols_hg38, group := "mQTLcontrols"]
# Compute cumulative position offsets for Manhattan plot
setorder(dt, chr, pos)
offsets <- dt[, .(max_pos = max(pos, na.rm = TRUE)), by = chr]
offsets[, cum_offset := c(0, head(cumsum(as.numeric(max_pos)), -1))]
dt <- merge(dt, offsets[, .(chr, cum_offset)], by = "chr", all.x = TRUE, sort = FALSE)
# Convert to integer/numeric if not already
dt[, cum_offset := as.numeric(cum_offset)]
dt[, pos2 := pos + cum_offset]
return(dt)
}
system.time(Atlas_dt <- prepAtlasdt(file))
print("Number of CpG tested:")
print(nrow(Atlas_dt)) # 23036026
print(paste0("Saving results for ", file, "in ", here(paste0("gitignore/fullres_", file))))
saveRDS(Atlas_dt, file = here(paste0("gitignore/fullres_", file)))
print("Saved")
}
}
##################
## 1_byDevLayer ##
##################
list.files(here("gitignore"))
X <- readRDS(here("gitignore/fullres_Atlas10X"))
Y <- readRDS(here("gitignore/fullres_Atlas10X_1_byDevLayer"))
# Ensure data.table types
setDT(X); setDT(Y)
# Keep only what you need
X <- X[, .(name, alpha_X = alpha)]
Y <- Y[, .(name, alpha_Y = alpha)]
# Set keys for efficient joins (optional but helpful on very large data)
setkey(X, name)
setkey(Y, name)
# Inner join (only names present in both)
Z_inner <- X[Y, nomatch = 0]
p1 <- ggplot(Z_inner, aes(x=alpha_X, y=alpha_Y)) +
geom_point(pch = 21, alpha = 0.05) +
geom_abline(slope = 1, linetype = 3) +
geom_smooth(linetype = 3)+
geom_smooth(method = "lm", fill = "black") +
theme_minimal(base_size = 14) +
guides(fill = guide_legend(position = "inside"))+
theme(legend.position.inside = c(0.18,0.85),
legend.box = "horizontal", legend.title = element_blank(),
legend.background = element_rect(fill = "white", color = "black", linewidth = 0.4),
legend.key = element_rect(fill = "white", color = NA)) +
labs(title = "Proba(hypervariable) at common CpGs",
x = "Pr(hv) calculated on WGBS atlas datasets with 46 groups (cell-tissue)",
y = "Pr(hv) calculated on WGBS atlas datasets with 3 groups (dvp layers)") +
scale_x_continuous(breaks = seq(0, 1, by = .1)) +
scale_y_continuous(breaks = seq(0, 1, by = .1))
pdf(here("05_hvCpGalgorithm/figures/correlation_Atlas10X_0_vs_1_byDevLayer.pdf"), width = 5, height = 5)
p1
